<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A‑Frame Θάλασσα • Κίνηση + Κύματα</title>
  <style>
    html, body { height: 100%; margin: 0; }
    body { background: #0b1422; overflow: hidden; }
    .hud { position: fixed; left: 10px; top: 10px; color:#e6f0ff; background: rgba(0,0,0,.35); padding:8px 10px; border-radius: 10px; font: 13px system-ui; z-index: 5; pointer-events: none; }
    .hud kbd{background: rgba(255,255,255,.15); padding: 2px 6px; border-radius: 6px;}
  </style>
  <!-- A‑Frame + Extras (ocean + movement-controls) → σταθερό σε GitHub Pages -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <script>
    // Κάνει τον ωκεανό «άπειρο» ακολουθώντας τον παίκτη
    AFRAME.registerComponent('follow-player', {
      schema: {y: {type:'number', default: 0}},
      tick: function(){
        const rig = this.el.sceneEl && this.el.sceneEl.querySelector('#rig');
        if(!rig) return;
        const p = rig.object3D.position;
        this.el.object3D.position.set(p.x, this.data.y, p.z);
      }
    });
  </script>
</head>
<body>
  <div class="hud">Θέαση: κάνε κλικ μέσα στο παράθυρο για pointer‑lock • Κίνηση: <kbd>WASD</kbd> • Sprint: <kbd>Shift</kbd> • Reset: <kbd>R</kbd></div>

  <a-scene renderer="colorManagement: true" background="color: #0b1422">
    <!-- Φώτα -->
    <a-entity light="type: directional; intensity: 1.0; castShadow: false" position="-200 300 -120"></a-entity>
    <a-entity light="type: ambient; intensity: 0.2; color: #5a7cff"></a-entity>

    <!-- Ουρανός -->
    <a-sky color="#0e1422"></a-sky>

    <!-- Ωκεανός από aframe-extras (animated) + infinite follow -->
    <!-- ΣΗΜ.: Το component 'ocean' δημιουργεί κινούμενα κύματα (choppy) στο GPU. -->
    <a-entity id="ocean"
              ocean="width: 12000; depth: 12000; density: 80; amplitude: 2.8; speed: 1.2; color: #2979ff; opacity: 1"
              rotation="-90 0 0"
              follow-player="y: 0">
    </a-entity>

    <!-- RIG παίκτη με movement-controls (από aframe-extras) -->
    <a-entity id="rig" position="0 2 0" movement-controls="fly: true; speed: 0.15">
      <a-entity camera look-controls="pointerLockEnabled: true" position="0 1.6 0"></a-entity>
    </a-entity>
  </a-scene>

  <script>
    // Sprint & Reset πάνω στο movement-controls
    (function(){
      const scene = document.querySelector('a-scene');
      const rig = document.querySelector('#rig');
      let sprint=false;
      window.addEventListener('keydown', (e)=>{ if(e.code==='ShiftLeft'||e.code==='ShiftRight') sprint=true; if(e.code==='KeyR'){ rig.setAttribute('position', {x:0,y:2,z:0}); } });
      window.addEventListener('keyup', (e)=>{ if(e.code==='ShiftLeft'||e.code==='ShiftRight') sprint=false; });
      scene.addEventListener('loaded', ()=>{
        const mc = rig.components['movement-controls'];
        const baseSpeed = 0.15;
        scene.addEventListener('tick', ()=>{ if(!mc) return; mc.data.speed = sprint ? baseSpeed*3 : baseSpeed; });
      });
    })();
  </script>
</body>
</html>
